
---
title: "TimeSeriesFinalProject"
author: "GroupBeer "
date: "2024-02-20"
output: html_document
---

```{r}
library(data.table)
library(dplyr)
library(forecast)
library(caret)
library(neuralnet)
library(gains)
library(ggplot2)

```



```{r}
OctoberFest <- read.csv("~/Desktop/GraduateSchool/S3/Time Series/Data/oktoberfest 1985 2022.csv", header=T, stringsAsFactors=T)

Beer <- ts(OctoberFest$Beer_consumption)
visitors <- ts(OctoberFest$Visitors_total)
Chicken <- ts(OctoberFest$Chicken_consumption)

plot(OctoberFest$Year, visitors, type="l", col="darkorange2")
plot(OctoberFest$Year, Beer, type="l", col="darkorange2")
plot(OctoberFest$Year, Chicken, type="l", col="darkorange2")

# Beer <- ts(OctoberFest$Beer_consumption, start = c(1985, 1), end = c(2022, 1), freq = 1)
# visitors <- ts(OctoberFest$Visitors_total, start = c(1985, 1), end = c(2022, 1), freq = 1)
# Chicken <- ts(OctoberFest$Chicken_consumption, start = c(1985, 1), end = c(2022, 1), freq = 1)

```


```{r}
#Visitors
DT_visitors<-tslm(visitors~trend)
summary(DT_visitors)

DTVisitors<-DT_visitors$residuals
par(mfrow=c(1,1))
plot(DTVisitors)

par(mfrow=c(1,2))
Acf(DTVisitors, col="red", main="ACF Function")
Pacf(DTVisitors, col="blue", main="PACF Function")
```

```{r}
#Beer
DT_Beer<-tslm(Beer~trend+I(trend^2)+I(trend^3))
summary(DT_Beer)

DTBeer<-DT_Beer$residuals
par(mfrow=c(1,1))
plot(DTBeer)

par(mfrow=c(1,2))
Acf(DTBeer, col="red", main="ACF Function")
Pacf(DTBeer, col="blue", main="PACF Function")
```


```{r}
#Chicken
OctoberFest$SB <- ifelse(OctoberFest$Year < 2000, 1, 0)

SB <- ts(OctoberFest$SB)

DT_Chicken<-tslm(Chicken~trend+SB)
summary(DT_Chicken)

DTChicken<-DT_Chicken$residuals
par(mfrow=c(1,1))
plot(DTChicken)

par(mfrow=c(1,2))
Acf(DTChicken, col="red", main="ACF Function")
Pacf(DTChicken, col="blue", main="PACF Function")


```


Needs correction
```{r}
#Arima Beer Forecast
Beer.ts <- ts(OctoberFest$Beer_consumption, start = c(1985, 1), end = c(2022, 1), freq = 1) 
nValid <- 5
nBeer <- length(Beer.ts) - nValid
Beer.ts <- window(Beer.ts, start = c(1985, 1), end = c(2022, nBeer))
valid.ts <- window(Beer.ts, start = c(1985, nBeer + 1), end = c(2022, nBeer + nValid))

DTBeer<-DT_Beer$residuals
Beer.res.arima <- Arima(DTBeer, order = c(1,0,0))
Beer.res.arima.pred <- forecast(Beer.res.arima, h = nValid) 

par(mfrow=c(1,1)) 
plot(Beer.res.arima.pred)
lines(Beer.res.arima.pred$fitted, lwd = 2, col = "purple")
axis(1, at = seq(1985, 2015, 1), labels = format(seq(1985, 2015, 1)))


summary(Beer.res.arima)


AR_1_resids<-Beer.res.arima$residuals 
par(mfrow=c(1,2))
Acf(AR_1_resids)
Pacf(AR_1_resids)

```



